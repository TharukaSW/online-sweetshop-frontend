<header class="sticky top-0 z-50 border-b border-gray-200 bg-white/80 backdrop-blur">
	<div class="container mx-auto px-4">
		<div class="flex h-16 items-center justify-between">
			<a class="flex items-center gap-3" routerLink="/" (click)="closeMenu()">
				<div class="flex h-10 w-10 items-center justify-center rounded-xl bg-linear-to-br from-green-600 to-green-700 text-white shadow-sm">
					<span class="text-lg font-bold">OS</span>
				</div>
				<div class="leading-tight">
					<p class="text-sm font-extrabold tracking-tight text-gray-900">Organic SweetShop</p>
					<p class="text-xs text-gray-500">Fresh • Organic • Handcrafted</p>
				</div>
			</a>

			<nav class="hidden items-center gap-2 md:flex">
				<a
					*ngFor="let link of links"
					[routerLink]="link.path"
					routerLinkActive="bg-gray-100 text-gray-900"
					[routerLinkActiveOptions]="{ exact: link.path === '/' }"
					class="rounded-lg px-3 py-2 text-sm font-semibold text-gray-700 transition hover:bg-gray-50 hover:text-gray-900"
				>
					{{ link.label }}
				</a>
			</nav>

			<div class="flex items-center gap-2">
				<!-- Cart Button -->
				<a routerLink="/cart" class="relative inline-flex items-center justify-center rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm font-semibold text-gray-700 shadow-sm transition hover:bg-gray-50">
					<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
					</svg>
					<span class="ml-2 hidden sm:inline">Cart</span>
					<span
						*ngIf="cartCount() > 0"
						class="absolute -right-2 -top-2 rounded-full bg-green-600 px-2 py-0.5 text-xs font-bold text-white"
					>
						{{ cartCount() }}
					</span>
				</a>

				<!-- Auth Buttons -->
				<div *ngIf="!isAuthenticated()" class="hidden md:flex items-center gap-2">
					<a routerLink="/login" class="rounded-lg px-4 py-2 text-sm font-semibold text-gray-700 transition hover:bg-gray-50">
						Login
					</a>
					<a routerLink="/register" class="rounded-lg bg-linear-to-r from-green-600 to-green-700 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:from-green-700 hover:to-green-800">
						Sign Up
					</a>
				</div>

				<!-- User Menu -->
				<div *ngIf="isAuthenticated() && (currentUser$ | async) as user" class="hidden md:flex items-center gap-2">
					<div class="flex items-center gap-2 rounded-lg border border-gray-200 bg-white px-3 py-2">
						<div class="h-8 w-8 rounded-full bg-linear-to-br from-green-600 to-green-700 flex items-center justify-center text-white text-sm font-bold">
							{{ user.firstName.charAt(0) }}{{ user.lastName.charAt(0) }}
						</div>
						<span class="text-sm font-semibold text-gray-700">{{ user.firstName }}</span>
					</div>
					<button
						(click)="onLogout()"
						class="rounded-lg border border-gray-200 bg-white px-4 py-2 text-sm font-semibold text-gray-700 shadow-sm transition hover:bg-gray-50"
					>
						Logout
					</button>
				</div>

				<!-- Mobile Menu Button -->
				<button
					type="button"
					class="inline-flex items-center justify-center rounded-lg border border-gray-200 bg-white p-2 text-gray-700 shadow-sm transition hover:bg-gray-50 md:hidden"
					(click)="toggleMenu()"
					aria-label="Toggle menu"
				>
					<svg *ngIf="!isMenuOpen" class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
					</svg>
					<svg *ngIf="isMenuOpen" class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
					</svg>
				</button>
			</div>
		</div>

		<div *ngIf="isMenuOpen" class="md:hidden">
			<div class="border-t border-gray-200 py-3">
				<nav class="flex flex-col">
					<a
						*ngFor="let link of links"
						[routerLink]="link.path"
						routerLinkActive="bg-gray-100 text-gray-900"
						[routerLinkActiveOptions]="{ exact: link.path === '/' }"
						(click)="closeMenu()"
						class="rounded-lg px-3 py-2 text-sm font-semibold text-gray-700 transition hover:bg-gray-50 hover:text-gray-900"
					>
						{{ link.label }}
					</a>
					
					<!-- Mobile Auth Links -->
					<div class="mt-4 border-t border-gray-200 pt-4">
						<div *ngIf="!isAuthenticated()" class="flex flex-col gap-2">
							<a routerLink="/login" (click)="closeMenu()" class="rounded-lg px-3 py-2 text-sm font-semibold text-gray-700 transition hover:bg-gray-50">
								Login
							</a>
							<a routerLink="/register" (click)="closeMenu()" class="rounded-lg bg-linear-to-r from-green-600 to-green-700 px-3 py-2 text-sm font-semibold text-white text-center">
								Sign Up
							</a>
						</div>
						<div *ngIf="isAuthenticated() && (currentUser$ | async) as user">
							<div class="flex items-center gap-2 px-3 py-2 mb-2">
								<div class="h-10 w-10 rounded-full bg-linear-to-br from-green-600 to-green-700 flex items-center justify-center text-white font-bold">
									{{ user.firstName.charAt(0) }}{{ user.lastName.charAt(0) }}
								</div>
								<div>
									<p class="text-sm font-semibold text-gray-900">{{ user.firstName }} {{ user.lastName }}</p>
									<p class="text-xs text-gray-500">{{ user.email }}</p>
								</div>
							</div>
							<button
								(click)="onLogout()"
								class="w-full rounded-lg border border-gray-200 px-3 py-2 text-sm font-semibold text-gray-700 transition hover:bg-gray-50"
							>
								Logout
							</button>
						</div>
					</div>
				</nav>
			</div>
		</div>
	</div>
</header>
