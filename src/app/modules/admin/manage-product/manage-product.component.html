<div class="container mx-auto px-4 py-8">
	<div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
		<div>
			<h1 class="text-2xl font-extrabold tracking-tight text-gray-900">Manage Products</h1>
			<p class="mt-1 text-sm text-gray-600">Add, edit, and delete products.</p>
		</div>
		<button type="button"
			class="inline-flex items-center justify-center rounded-lg bg-green-600 px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition hover:bg-green-700"
			(click)="onAddProduct()">
			Add Product
		</button>
	</div>

	<div *ngIf="showForm" class="mt-8 rounded-2xl border border-gray-200 bg-white p-6 shadow-sm">
		<div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
			<h2 class="text-lg font-bold text-gray-900">{{ isEditing ? 'Edit Product' : 'Add Product' }}</h2>
			<button type="button" class="text-sm font-semibold text-gray-600 hover:text-gray-900"
				(click)="onCancel()">Close</button>
		</div>

		<form class="mt-6 grid grid-cols-1 gap-4 md:grid-cols-2" [formGroup]="productForm" (ngSubmit)="onSaveProduct()">
			<div>
				<label class="block text-sm font-semibold text-gray-700" for="id">Product ID</label>
				<input id="id" type="text" formControlName="id"
					class="mt-2 w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-300"
					placeholder="e.g. 1001" />
			</div>

			<div>
				<label class="block text-sm font-semibold text-gray-700" for="name">Name</label>
				<input id="name" type="text" formControlName="name"
					class="mt-2 w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-300"
					placeholder="Product name" />
			</div>

			<div>
				<label class="block text-sm font-semibold text-gray-700" for="price">Price</label>
				<input id="price" type="number" formControlName="price"
					class="mt-2 w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-300"
					placeholder="0" />
			</div>

			<div>
				<label class="block text-sm font-semibold text-gray-700" for="stockCount">Stock</label>
				<input id="stockCount" type="number" formControlName="stockCount"
					class="mt-2 w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-300"
					placeholder="0" />
			</div>

			<div class="md:col-span-2">
				<label class="block text-sm font-semibold text-gray-700" for="image">Image URL</label>
				<input id="image" type="text" formControlName="image"
					class="mt-2 w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-300"
					placeholder="/placeholder.svg" />
			</div>

			<div class="md:col-span-2">
				<label class="block text-sm font-semibold text-gray-700" for="shortDescription">Short
					Description</label>
				<input id="shortDescription" type="text" formControlName="shortDescription"
					class="mt-2 w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-300"
					placeholder="A short description" />
			</div>

			<div class="md:col-span-2">
				<label class="block text-sm font-semibold text-gray-700" for="description">Description</label>
				<textarea id="description" rows="3" formControlName="description"
					class="mt-2 w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-300"
					placeholder="Full description"></textarea>
			</div>

			<div>
				<label class="block text-sm font-semibold text-gray-700" for="category">Category</label>
				<select id="category" formControlName="category"
					class="mt-2 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-300">
					<option [ngValue]="null" disabled>Select category</option>
					<option *ngFor="let c of (categories$ | async)" [ngValue]="c._id">{{ c.name }}</option>
				</select>
			</div>

			<div>
				<label class="block text-sm font-semibold text-gray-700" for="discount">Discount (%)</label>
				<input id="discount" type="number" formControlName="discount"
					class="mt-2 w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-300"
					placeholder="0" />
			</div>

			<div>
				<label class="block text-sm font-semibold text-gray-700" for="expiryDate">Expiry Date</label>
				<input id="expiryDate" type="date" formControlName="expiryDate"
					class="mt-2 w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-300" />
			</div>

			<div class="flex items-center gap-4">
				<label class="inline-flex items-center gap-2 text-sm text-gray-700">
					<input type="checkbox" formControlName="featured" class="h-4 w-4 rounded border-gray-300" />
					Featured
				</label>
				<label class="inline-flex items-center gap-2 text-sm text-gray-700">
					<input type="checkbox" formControlName="isNewProduct" class="h-4 w-4 rounded border-gray-300" />
					New
				</label>
				<label class="inline-flex items-center gap-2 text-sm text-gray-700">
					<input type="checkbox" formControlName="isLimited" class="h-4 w-4 rounded border-gray-300" />
					Limited
				</label>
			</div>

			<div class="md:col-span-2 flex flex-col gap-3 sm:flex-row sm:justify-end">
				<button type="button"
					class="rounded-lg border border-gray-200 bg-white px-5 py-2.5 text-sm font-semibold text-gray-700 transition hover:bg-gray-50"
					(click)="onCancel()">Cancel</button>
				<button type="submit"
					class="rounded-lg bg-green-600 px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition hover:bg-green-700">Save</button>
			</div>
		</form>
	</div>

	<div class="mt-10 overflow-hidden rounded-2xl border border-gray-200 bg-white shadow-sm">
		<div class="flex items-center justify-between border-b border-gray-200 px-6 py-4">
			<h2 class="text-lg font-bold text-gray-900">All Products</h2>
			<p class="text-sm text-gray-500">Edit or remove items from your catalog.</p>
		</div>

		<div class="overflow-x-auto">
			<table class="min-w-full divide-y divide-gray-200">
				<thead class="bg-gray-50">
					<tr>
						<th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-600">
							Name</th>
						<th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-600">ID
						</th>
						<th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-600">
							Category</th>
						<th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-600">
							Price</th>
						<th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-600">
							Stock</th>
						<th class="px-6 py-3 text-right text-xs font-semibold uppercase tracking-wider text-gray-600">
							Actions</th>
					</tr>
				</thead>
				<tbody class="divide-y divide-gray-100 bg-white">
					<tr *ngFor="let p of (products$ | async)">
						<td class="px-6 py-4">
							<div class="flex items-center gap-3">
								<img class="h-10 w-10 rounded-lg object-cover" [src]="p.image || '/placeholder.svg'"
									[alt]="p.name" />
								<div>
									<p class="font-semibold text-gray-900">{{ p.name }}</p>
									<p class="text-xs text-gray-500">{{ p.shortDescription }}</p>
								</div>
							</div>
						</td>
						<td class="px-6 py-4 text-sm text-gray-700">{{ p.id }}</td>
						<td class="px-6 py-4 text-sm text-gray-700">{{ p.category }}</td>
						<td class="px-6 py-4 text-sm text-gray-700">{{ p.price }}</td>
						<td class="px-6 py-4 text-sm text-gray-700">{{ p.stockCount }}</td>
						<td class="px-6 py-4 text-right">
							<div class="inline-flex items-center gap-2">
								<button type="button"
									class="rounded-lg bg-emerald-600 px-3 py-2 text-sm font-semibold text-white transition hover:bg-emerald-700"
									(click)="onDeleteProduct(p)">View</button>

								<button type="button"
									class="rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm font-semibold text-gray-700 transition hover:bg-gray-50"
									(click)="onEditProduct(p)">Edit</button>
								<button type="button"
									class="rounded-lg bg-red-600 px-3 py-2 text-sm font-semibold text-white transition hover:bg-red-700"
									(click)="onDeleteProduct(p)">Delete</button>
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
</div>